% translate with >> pdflatex -shell-escape <file>
\documentclass{article}

\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{siunitx}
\pgfplotsset{compat=newest}

\pgfplotsset{compat=newest} % Allows to place the legend below plot

\pagestyle{empty}

\definecolor{colorA}{RGB}{142,66,255}
\definecolor{colorB}{RGB}{58,60,255}
\definecolor{colorC}{RGB}{74, 255,242}
\definecolor{colorD}{RGB}{78,255,103}

\definecolor{colorE}{RGB}{235,190,49}


\begin{document}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          %legend style={at={(0.12,0.95)},anchor=north},
          legend pos=outer north east,
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=10.5,
          xticklabels from table={stencil_weak/weak128.csv}{Nodes},
          ymin=0,
          cycle list name=exotic,
          %every axis plot/.append style={fill,draw=none,no markers}
        ]
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak128.csv};
        %\addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak192.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak256.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak512.csv};
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak1024.csv};
        \legend{$N=128^3$, $N=256^3$, $N=512^3$, $N=1024^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Weak Scaling of GridTools 3d7pt stencil (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          %legend style={at={(0.12,0.95)},anchor=north},
          legend pos=outer north east,
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=10.5,
          xticklabels from table={stencil_weak/weak128.csv}{Nodes},
          ymin=0,
          cycle list name=exotic,
          %every axis plot/.append style={fill,draw=none,no markers}
        ]
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak128_reduce.csv};
        %\addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak192_reduce.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak256_reduce.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak512_reduce.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {stencil_weak/weak1024_reduce.csv}; 
        \legend{$N=128^3$, $N=256^3$, $N=512^3$, $N=1024^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Weak Scaling of GridTools 3d7pt stencil and reduction operator (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}


\clearpage
%============================================================================================================
%============================================================================================================

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.95)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={cg_naive/naive256.csv}{Nodes},
          ymin=0,
          cycle list name=exotic,
          %every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive64.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive96.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive128.csv}; %TODO - fix race condition so that iteration count is fixed
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive256.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive512.csv}; 
         
        \legend{$N=64^3$, $N=96^3$, $N=128^3$, $N=256^3$, $N=512^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Strong Scaling test of CG in GridTools(gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.95)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc64_naive.csv}{Nodes},
          ymin=0,
          cycle list name=exotic,
          %every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc64_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc96_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc128_naive.csv}; %TODO - fix race condition so that iteration count is fixed
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc256_naive.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc512_naive.csv}; 
         
        \legend{$N=64^3$, $N=96^3$, $N=128^3$, $N=256^3$, $N=512^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Strong Scaling test of CG in PETSc(gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Iteration, % Set the labels
          ylabel=Residual,
          legend style={at={(0.85,0.98)},anchor=north},
          %enlargelimits=false,
          %xtick=data,
          %xmin=0, xmax=7.5,
          %xticklabels from table={cg_naive/residual128_1.csv}{Iter},
          %ymin=0,
          cycle list name=exotic,
          every axis plot/.append style={no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_1.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_2.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_4.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_8.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_16.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_32.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_64.csv}; 
         
        \legend{1 node, 2 nodes, 4 nodes, 8 nodes, 16 nodes, 32 nodes, 64 nodes}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Residual of CG in GridTools for $N=128^3$ (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Iteration, % Set the labels
          ylabel=Residual,
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          %xtick=data,
          %xmin=0, xmax=7.5,
          %xticklabels from table={cg_naive/residual128_1.csv}{Iter},
          %ymin=0,
          cycle list name=exotic,
          every axis plot/.append style={no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_1.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_2.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_4.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_8.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_16.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_32.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_64.csv}; 
         
        \legend{1 node, 2 nodes, 4 nodes, 8 nodes, 16 nodes, 32 nodes, 64 nodes}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Residual of CG in PETSc for $N=128^3$ (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Iteration, % Set the labels
          ylabel=Residual,
          legend pos=outer north east,
          %legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          %xtick=data,
          %xmin=0, xmax=7.5,
          %xticklabels from table={cg_naive/residual128_1.csv}{Iter},
          %ymin=0,
          cycle list name=exotic,
          every axis plot/.append style={no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Iter,y expr=\thisrow{Residual}/512, col sep=space] {cg_naive/petsc_residual64_1.csv};
        \addplot table[x=Iter,y expr=\thisrow{Residual}/9.406040612287e+02, col sep=space] {cg_naive/petsc_residual96_1.csv};
        \addplot table[x=Iter,y expr=\thisrow{Residual}/1.448154687870e+03, col sep=space] {cg_naive/petsc_residual128_1.csv};
        \addplot table[x=Iter,y expr=\thisrow{Residual}/4.096000000000e+03, col sep=space] {cg_naive/petsc_residual256_1.csv};
        \addplot table[x=Iter,y expr=\thisrow{Residual}/1.158523750296e+04, col sep=space] {cg_naive/petsc_residual512_1.csv};
         
        \legend{$N=64^3$, $N=96^3$, $N=128^3$, $N=256^3$, $N=512^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Relative residual of CG in PETSc for various problem sizes up to $reltol=1e-8$ (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc64_naive.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc64_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive64.csv}; 
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of CG with $N=64^3$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc96_naive.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc96_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive96.csv}; 
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of CG with $N=96^3$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc128_naive.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc128_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive128.csv}; 
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of CG with $N=128^3$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc256_naive.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc256_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive256.csv}; 
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of CG with $N=256^3$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc_naive/petsc512_naive.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc_naive/petsc512_naive.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg_naive/naive512.csv}; 
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of CG with $N=512^3$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\clearpage
%============================================================================================================
%============================================================================================================

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          %legend style={at={(0.75,0.9)},anchor=north},
          legend pos=outer north east,
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={cg/cg128.csv}{Nodes},
          ymin=0,
          cycle list name=exotic,
          %every axis plot/.append style={fill,draw=none,no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {cg/cg64.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg/cg96.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg/cg128.csv}; %considering fixed iteration count
        \addplot table[x=Id,y=Time,col sep=space] {cg/cg256.csv};
        \addplot table[x=Id,y=Time,col sep=space] {cg/cg512.csv};
         
        \legend{$N=64^3$, $N=96^3$, $N=128^3$, $N=256^3$, $N=512^3$}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Strong Scaling test of PCG in GridTools(gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Iteration, % Set the labels
          ylabel=Relative residual,
          legend style={at={(0.85,0.99)},anchor=north},
          %enlargelimits=false,
          %xtick=data,
          %xmin=0,
          xmax=100,
          %xticklabels from table={cg/residual128_1.csv}{Iter},
          %ymin=0,
          cycle list name=exotic,
          every axis plot/.append style={no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        %\addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_1.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_2.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_4.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_8.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_16.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_32.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_64.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual128_128.csv}; 
         
        \legend{2 nodes, 4 nodes, 8 nodes, 16 nodes, 32 nodes, 64 nodes, 128 nodes}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Relative residual of PCG for $N=128^3$ in GridTools (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Iteration, % Set the labels
          ylabel=Relative residual,
          legend style={at={(0.85,0.99)},anchor=north},
          %enlargelimits=false,
          %xtick=data,
          %xmin=0,
          xmax=150,
          %xticklabels from table={cg/residual128_1.csv}{Iter},
          %ymin=0,
          cycle list name=exotic,
          every axis plot/.append style={no markers}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual256_16.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual256_32.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual256_64.csv};
        \addplot table[x=Iter,y=Residual,col sep=space] {cg/residual256_128.csv}; 
         
        \legend{16 nodes, 32 nodes, 64 nodes, 128 nodes}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Relative residual of PCG for $N=256^3$ in GridTools (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

% \begin{figure}[ht!]
%   \begin{center}
%     \begin{tikzpicture}
%       \begin{semilogyaxis}[
%           %ybar,
%           width=\linewidth, % Scale the plot to \linewidth
%           grid=major, 
%           grid style={dashed,gray!30},
%           xlabel=Iteration, % Set the labels
%           ylabel=Residual,
%           legend style={at={(0.95,0.99)},anchor=north},
%           %enlargelimits=false,
%           %xtick=data,
%           %xmin=0,
%           xmax=65,
%           %xticklabels from table={cg/residual128_1.csv}{Iter},
%           %ymin=0,
%           cycle list name=exotic,
%           every axis plot/.append style={no markers}
%           %TODO - treat x numbers as categorical, equal spacing on x-axis
%         ]
%         %\addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_1.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_2.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_4.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_8.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_16.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_32.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg/petsc_residual128_64.csv}; 
         
%         \legend{2 nodes, 4 nodes, 8 nodes, 16 nodes, 32 nodes, 64 nodes}
%       \end{semilogyaxis}
%     \end{tikzpicture}
%     \caption{Residual of PCG for $N=128^3$ in PETSc with MKL Pardiso (icc 15.0.1, Intel Xeon E5-2670).}
%   \end{center}
% \end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          log origin=infty,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=0.5, xmax=8.5,
          xticklabels from table={petsc/gt128.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={very thick}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc/petsc128.csv}; 
        \addplot table[x=Id,y=Time,col sep=space] {petsc/gt128.csv}; %considering TTS

        \node[] at (axis cs:1.6,1) {(NaN)};
         
        \legend{PETSc, GridTools}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of PCG with $N=128^3$ and $rtol = 1e-8$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

\begin{figure}[ht!]
  \begin{center}
    \begin{tikzpicture}
      \begin{semilogyaxis}[
          %ybar,
          width=\linewidth, % Scale the plot to \linewidth
          grid=major, 
          grid style={dashed,gray!30},
          xlabel=Number of Nodes, % Set the labels
          ylabel=Time (s),
          legend style={at={(0.85,0.9)},anchor=north},
          %enlargelimits=false,
          xtick=data,
          xmin=4.5, xmax=8.5,
          xticklabels from table={petsc/petsc256.csv}{Nodes},
          cycle list name=exotic,
          every axis plot/.append style={very thick}
          %TODO - treat x numbers as categorical, equal spacing on x-axis
        ]
        \addplot table[x=Id,y=Time,col sep=space] {petsc/petsc256.csv};
        \addplot table[x=Id,y=Time,col sep=space] {petsc/gt256.csv}; %considering TTS 

        %add ideal scaling
        %\addplot [dashed] coordinates {(5,600) (8, 600)};
         
        \legend{PETSc, GridTools, Ideal}
      \end{semilogyaxis}
    \end{tikzpicture}
    \caption{Time to Solution of PCG with $N=256^3$ and $rtol = 1e-8$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
  \end{center}
\end{figure}

% \begin{figure}[ht!]
%   \begin{center}
%     \begin{tikzpicture}
%       \begin{semilogyaxis}[
%           ybar,
%           log origin=infty,
%           width=\linewidth, % Scale the plot to \linewidth
%           grid=major, 
%           grid style={dashed,gray!30},
%           xlabel=Number of Nodes, % Set the labels
%           ylabel=Time (s),
%           legend style={at={(0.25,0.9)},anchor=north},
%           %enlargelimits=false,
%           xtick=data,
%           xmin=0.5, xmax=8.5,
%           xticklabels from table={petsc/petsc512.csv}{Nodes},
%           cycle list name=exotic,
%           every axis plot/.append style={fill,draw=none,no markers}
%           %TODO - treat x numbers as categorical, equal spacing on x-axis
%         ]
%         \addplot table[x=Id,y=Time,col sep=space] {petsc/petsc512.csv};
%         \addplot table[x=Id,y=Time,col sep=space] {petsc/gt512.csv};
         
         
%         \legend{PETSc, GridTools}
%       \end{semilogyaxis}
%     \end{tikzpicture}
%     \caption{Time to Solution of PCG with $N=512^3$ and $rtol = 1e-8$ in GridTools and PETSc (gcc/4.8.2, Intel Xeon E5-2670).}
%   \end{center}
% \end{figure}

% \begin{figure}[ht!]
%   \begin{center}
%     \begin{tikzpicture}
%       \begin{axis}[
%           %ybar,
%           width=\linewidth, % Scale the plot to \linewidth
%           grid=major, 
%           grid style={dashed,gray!30},
%           xlabel=Iteration, % Set the labels
%           ylabel=Residual,
%           legend style={at={(0.85,0.9)},anchor=north},
%           enlargelimits=false,
%           enlarge y limits=0.05,
%           %xtick=data,
%           %xmin=0, xmax=7.5,
%           %xticklabels from table={cg/residual128_1.csv}{Iter},
%           %ymin=0,
%           cycle list name=exotic,
%           every axis plot/.append style={no markers}
%           %TODO - treat x numbers as categorical, equal spacing on x-axis
%         ]
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_2.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_4.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_8.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_16.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/residual128_64.csv};
%         \addplot table[x=Iter,y=Residual,col sep=space] {cg_naive/petsc_residual128_16.csv};
         
%         \legend{GT-2, GT-4, GT-8, GT-16, GT-64, PTSC}
%       \end{axis}
%     \end{tikzpicture}
%     \caption{Testing Purposes (They need to absolutely overlap)}
%   \end{center}
% \end{figure}

\end{document}
